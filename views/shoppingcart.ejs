<h1 class="text-3xl font-bold text-gray-800 mb-6">Your Shopping Cart</h1>

<% if (typeof cart !=='undefined' && cart.items && cart.items.length> 0) { %>
    <div class="bg-white p-6 card mb-6">
        <div class="space-y-4">
            <% cart.items.forEach(item=> { %>
                <div class="flex items-center justify-between border-b pb-4 last:border-b-0 last:pb-0">
                    <div class="flex items-center space-x-4">
                        <img src="<%= item.imageUrl || 'https://placehold.co/80x80/cccccc/333333?text=Item' %>"
                            alt="<%= item.name %>" class="w-20 h-20 object-cover rounded-md">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">
                                <%= item.name %>
                            </h3>
                            <p class="text-gray-600">Price: $<%= item.price.toFixed(2) %>
                            </p>
                            <p class="text-gray-600">Subtotal: $<%= (item.price * item.quantity).toFixed(2) %>
                            </p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <form action="/cart/update/<%= item.productId %>?_method=PUT" method="POST"
                            class="flex items-center">
                            <label for="quantity-<%= item.productId %>" class="sr-only">Quantity</label>
                            <input type="number" id="quantity-<%= item.productId %>" name="quantity"
                                value="<%= item.quantity %>" min="0" class="form-input w-20 text-center mr-2"
                                onchange="this.form.submit()">
                            <button type="submit"
                                class="btn btn-secondary px-3 py-1 text-sm hidden md:inline-block">Update</button>
                        </form>
                        <form action="/cart/remove/<%= item.productId %>?_method=DELETE" method="POST">
                            <button type="submit" class="text-red-600 hover:text-red-800 font-medium">Remove</button>
                        </form>
                    </div>
                </div>
                <% }); %>
        </div>
    </div>

    <div class="bg-white p-6 card flex justify-between items-center">
        <h2 class="text-2xl font-bold text-gray-800">Total: $<%= typeof cart.totalPrice !=='undefined' ?
                cart.totalPrice.toFixed(2) : '0.00' %>
        </h2>
        <div class="flex space-x-4">
            <form action="/cart/clear?_method=DELETE" method="POST"
                onsubmit="return confirm('Are you sure you want to clear your entire cart?');">
                <button type="submit" class="btn btn-secondary px-6 py-3 text-lg">Clear Cart</button>
            </form>
            <a href="/checkout" class="btn btn-primary px-6 py-3 text-lg">Proceed to Checkout</a>
        </div>
    </div>
    <% } else { %>
        <div class="text-center text-gray-600 py-12 bg-white card">
            <p class="text-xl mb-4">Your cart is empty.</p>
            <a href="/products" class="btn btn-primary inline-block">Start Shopping</a>
        </div>
        <% } %>